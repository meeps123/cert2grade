{% extends "base.html" %}

{% block specific_stylesheets %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dropzone_basic.css') }}">
<style>
    .req_history_header {
        position: relative;
    }
    .req_history_header button {
        position: absolute;
        right: 0px;
        bottom: 0px;
    }
    .req_entry_row {
        position: relative;
    }
    .req_entry_row_selected {
        background-color: #D0DBF8;
    }
    .req_entry_row>input {
        position: absolute;
        left: -30px;
        cursor: pointer;
    }
    .req_entry_row:hover {
        background-color: #D0DBF8;
        cursor: pointer;
    }
    .req_code {
        display: inline-block;
        width: 20%;
    }
    .req_timestamp {
        display: inline-block;
        width: 25%;
    }
    .req_size {
        display: inline-block;
        width: 20%;
    }
    .req_duration {
        display: inline-block;
        width: 20%;
    }
</style>
{% endblock %}

{% block specific_scripts %}
<script src="{{ url_for('static', filename='js/dropzone.js') }}"></script>
<script>
    const SCRIPT_ROOT = {{ request.script_root|tojson }};
    let DROPZONE = new Dropzone('div#file_upload', {url: '/upload'});
</script>
<script src="{{ url_for('static', filename='js/index.js') }}"></script>    
{% endblock %}

{% block content %}
    <h1>upload files here</h1>
    <form 
        id="file_upload" 
        class="dropzone" 
        method="post" 
        enctype="multipart/form-data" 
        action="{{ url_for('dashboard.upload') }}"></form>
    <br>
    <div class="req_history_header">
        <h1>request history</h1>
        <button id="delete_req_btn" class="hidden"></button>
    </div>
    <div id="req_history" class="req_history">
        {% for message in get_flashed_messages() %}
            <div class="flash">{{ message }}</div>
        {% endfor %}
        <div class="req_entry_wrapper_title">
            <div class="req_code">code</div>
            <div class="req_timestamp">timestamp</div>
            <div class="req_size">size</div>
            <div class="req_duration">duration</div>
        </div>
        {% for req in req_history %}
            <div class="req_entry_row">
                <input type="checkbox" onclick="reqCheckboxClick(event, this, true)" unchecked>
                <div class="req_entry_wrapper" onclick="reqClick(event, this, false)" rowindex="{{ loop.index0 }}">
                    <div class="req_code">{{ req["code"] }}</div>
                    <div class="req_timestamp">{{ req["timestamp"] }}</div>
                    <div class="req_size">{{ req["files"] }} files ({{ req["size"] }}MB)</div>
                    <div class="req_duration">{{ req["duration"] }}s</div>
                </div>
                {% if not loop.last %}
                    <hr>
                {% endif %}
            </div>
        {% endfor %}
    </div>
   
{% endblock %}